import{_ as e,ae as a,D as t,b as s,M as n,ak as o,T as l}from"./vendor.931d8f24.js";import{r}from"./index.d0ed3dc5.js";import{C as c,L as i}from"./index.54d80d25.js";import{C as m}from"./index.90e87015.js";import{M as p}from"./index.0d0bb693.js";import{u as d}from"./useVisible.7f795f63.js";import{_ as v}from"./index.f4c393b6.js";const u=[{label:"version.js",value:"version"},{label:"app.js",value:"app"},{label:"web/app.js",value:"webapp"},{label:"admin/app.js",value:"adminapp"},{label:"download/app.js",value:"downloadapp"}];var f=l=>{const{file:i,value:u,histories:f,onRefresh:E}=l,[h,b]=e.useState(),[g,j]=e.useState(!1),C=d(),k=({key:a})=>r.get("/dev-ops/devops/configProxy/getHistory",{name:i,fileName:a}).then((t=>{const{success:s,data:n}=t;s&&o.info({title:"修改比较",width:1e3,content:e.createElement("div",{style:{width:"100%",overflow:"auto",height:600}},e.createElement(m,{title:[a,"线上"],value:[n,u]}))})}));return e.useEffect((()=>{b(u)}),[u]),e.createElement("div",{className:"operation-pane"},e.createElement("div",{className:"operation-pane__header"},g?e.createElement(a,null,e.createElement("a",{onClick:()=>{j(!1)}},"取消"),e.createElement("a",{onClick:()=>r.post("/dev-ops/devops/resource/write",v({content:h,name:i,filePath:"/data/webapps/statics/config/admin/version.js"})).then((e=>{j(!1),s.success("保存成功"),E()}))},"保存")):e.createElement(a,null,e.createElement("a",{onClick:()=>{j(!0)}},"编辑"),e.createElement("a",{onClick:()=>{C.open({title:`同步文件${i}`})}},"同步")),e.createElement("div",{className:"history"},(()=>{const a=e.createElement(n,{onClick:k},f.map((a=>e.createElement(n.Item,{key:a},a))));return e.createElement(t,{arrow:!0,trigger:"click",placement:"topRight",overlay:a},e.createElement("a",null,"历史记录"))})())),e.createElement("div",{className:"operation-pane__content"},e.createElement(c,{value:u,options:{languages:["javascript"]},editable:g,onChange:e=>{b(e)}})),C.visible&&e.createElement(p,{params:C.params,onCancel:C.close,onOk:e=>r.post("/dev-ops/devops/resource/push",v({ips:e.join(",")})).then((e=>{s.success("同步成功"),C.close(),E()}))}))};const{Header:E,Content:h}=i,{TabPane:b}=l;export default()=>{const[a,t]=e.useState("version"),[s,n]=e.useState(),[o,c]=e.useState([]),m=()=>{var e;e=a,r.get("/dev-ops/devops/resource/read",{name:e}).then((e=>{n(e.data)})),(e=>{r.get("/dev-ops/devops/configProxy/history",{name:e}).then((e=>{c(e.data)}))})(a)};return e.useEffect((()=>{m()}),[a]),e.createElement(i,null,e.createElement(E,{title:"前端配置"}),e.createElement(h,{wrapperClassName:"fe-config"},e.createElement("div",{className:"fe-config__header"},e.createElement(l,{activeKey:a,onChange:e=>{t(e)}},u.map((a=>e.createElement(b,{tab:a.label,key:a.value}))))),e.createElement("div",{className:"fe-config__content"},e.createElement(f,{file:a,value:s,histories:o,onRefresh:m}))))};

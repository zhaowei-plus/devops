var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,l=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,r=(e,r)=>{for(var i in r||(r={}))t.call(r,i)&&l(e,i,r[i]);if(n)for(var i of n(r))a.call(r,i)&&l(e,i,r[i]);return e};import{_ as i,ae as s,l as o,ak as d,h as p,b as c,ag as m,k as u}from"./vendor.931d8f24.js";import{L as g}from"./index.54d80d25.js";import{S as f}from"./index.cd79d446.js";import{r as h}from"./index.d0ed3dc5.js";import{u as b}from"./useList.da577dd6.js";import{u as y}from"./useVisible.7f795f63.js";import{a as E}from"./index.6547ff7d.js";var x=e=>{const{onOk:t,onCancel:n,params:a}=e,{title:l,record:s}=a,m=i.useMemo((()=>o.createAsyncFormActions()),[]),u=i.useMemo((()=>r({},s)),[s]);i.useEffect((()=>{}),[]);const g={pluginName:{type:"string",title:"PluginName","x-props":{placeholder:""}},pluginId:{type:"string",title:"PluginId","x-props":{placeholder:""}},pluginVersion:{type:"string",title:"PluginVersion","x-props":{placeholder:""}},pluginUri:{type:"string",title:"PluginUri","x-props":{placeholder:""}},pluginConf:{type:"textarea",title:"PluginConf","x-props":{placeholder:"",style:{height:"160px"}}}};return i.createElement(d,{visible:!0,centered:!0,title:l,onOk:()=>m.submit().then((({values:e})=>h.post("/awg-admin/api/plugin/save",e).then((()=>{c.success("添加成功"),t()})))),onCancel:n},i.createElement(p,{labelCol:6,validateFirst:!0,wrapperCol:16,initialValues:u,actions:m,schema:{type:"object",properties:E(g)}}))};const{Header:P,Content:C}=g;export default()=>{const e=b("/awg-admin/api/plugin/search"),t=y(),n=(t,n)=>{const a={1:"禁用",0:"启用"};return h.get("/awg-admin/api/plugin/changeStatus",{id:t,status:n}).then((t=>{c.success(`${a[n]}成功`),e.onRefresh()}))};i.useEffect((()=>{e.onRefresh()}),[]);const a={PluginName:{type:"string",title:"PluginName"},PluginId:{type:"string",title:"PluginId"}},l=(e=>{const{handleEdit:t,handleDelete:n,handleEnable:a,handleDisabled:l}=e;return[{title:"编号",dataIndex:"id",render:(e,t,n)=>n+1},{title:"PluginName",dataIndex:"pluginName"},{title:"PluginId",dataIndex:"pluginId"},{title:"PluginVersion",dataIndex:"pluginVersion"},{title:"操作",dataIndex:"enabled",render:(e,r)=>i.createElement(s,null,i.createElement("a",{onClick:()=>t(r)},"编辑"),e?i.createElement("a",{onClick:()=>l(r)},"禁用"):i.createElement("a",{onClick:()=>a(r)},"启用"),i.createElement("a",{onClick:()=>n(r)},"删除"))}]})({handleEdit:e=>{t.open({type:"edit",title:"编辑插件",record:e})},handleDelete:({id:t})=>{d.confirm({title:"删除后不可恢复，确定删除数据？",content:"",onOk:()=>{h.get("/awg-admin/api/plugin/delete",{id:t}).then((t=>{c.success("删除成功"),e.onRefresh()}))}})},handleEnable:({id:e})=>{n(e,0)},handleDisabled:({id:e})=>{n(e,1)}});return i.createElement(g,null,i.createElement(P,{title:"插件配置",extra:i.createElement(m,{type:"primary",onClick:()=>{t.open({type:"add",title:"新增插件"})}},"新增插件")}),i.createElement(C,{wrapperClassName:"plugin-config"},i.createElement(f,{schema:a,onSearch:e.onSearch}),i.createElement(u,r({columns:l},e.table))),t.visible&&i.createElement(x,{params:t.params,onCancel:t.close,onOk:()=>{t.close(),e.onRefresh()}}))};

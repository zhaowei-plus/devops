import{_ as e,ae as t,D as a,b as n,M as l,ak as s,T as o}from"./vendor.931d8f24.js";import{_ as r}from"./index.f4c393b6.js";import{C as c,L as i}from"./index.54d80d25.js";import{C as m}from"./index.90e87015.js";import{r as d}from"./index.d0ed3dc5.js";var p=o=>{const{file:i,value:p,histories:v,onRefresh:f}=o,[u,E]=e.useState(),[h,g]=e.useState(!1),b=({key:t})=>d.get("/dev-ops/devops/configProxy/getHistory",{name:i,fileName:t}).then((a=>{const{success:n,data:l}=a;n&&s.info({title:"修改比较",width:1e3,content:e.createElement("div",{style:{width:"100%",overflow:"auto",height:600}},e.createElement(m,{title:[t,"线上"],value:[l,p]}))})}));return e.useEffect((()=>{E(p)}),[p]),e.createElement("div",{className:"operation-pane"},e.createElement("div",{className:"operation-pane__header"},h?e.createElement(t,null,e.createElement("a",{onClick:()=>{g(!1)}},"取消"),e.createElement("a",{onClick:()=>d.post("/dev-ops/devops/configProxy/save",r({content:u,name:i})).then((e=>{g(!1),n.success("保存成功"),f()}))},"保存")):e.createElement(t,null,e.createElement("a",{onClick:()=>{g(!0)}},"编辑"),e.createElement("a",{onClick:e=>d.post("/dev-ops/devops/configProxy/reload").then((e=>{n.success("重启成功"),f()}))},"重启")),e.createElement("div",{className:"history"},(()=>{const t=e.createElement(l,{onClick:b},v.map((t=>e.createElement(l.Item,{key:t},t))));return e.createElement(a,{arrow:!0,trigger:"click",placement:"topRight",overlay:t},e.createElement("a",null,"历史记录"))})())),e.createElement("div",{className:"operation-pane__content"},e.createElement(c,{value:p,options:{languages:["bash"]},editable:h,onChange:e=>{E(e)}})))};const v=[{label:"variable",value:"variable"},{label:"biz",value:"biz"},{label:"bizapp",value:"bizapp"}];const{Header:f,Content:u}=i,{TabPane:E}=o;export default()=>{const[t,a]=e.useState("variable"),[n,l]=e.useState(),[s,r]=e.useState([]),c=()=>{var e;e=t,d.get("/dev-ops/devops/configProxy/get",{name:e}).then((e=>{l(e.data)})),(e=>{d.get("/dev-ops/devops/configProxy/history",{name:e,fileName:history}).then((e=>{r(e.data)}))})(t)};return e.useEffect((()=>{c()}),[t]),e.createElement(i,null,e.createElement(f,{title:"后端配置"}),e.createElement(u,{wrapperClassName:"ae-config"},e.createElement("div",{className:"ae-config__header"},e.createElement(o,{activeKey:t,onChange:e=>{a(e)}},v.map((t=>e.createElement(E,{tab:t.label,key:t.value}))))),e.createElement("div",{className:"ae-config__content"},e.createElement(p,{file:t,value:n,histories:s,onRefresh:c}))))};
